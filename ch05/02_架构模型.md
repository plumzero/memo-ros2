
参考:
- [Library Overview](https://fast-dds.docs.eprosima.com/en/latest/fastdds/library_overview/library_overview.html)

Fast DDS 的架构如下图所示，图中可以看到具有以下不同环境的层模型。
- Application layer: 使用 Fast DDS API 在分布式系统中实现通信的用户应用程序。
- Fast DDS layer: DDS 通信中间件的稳健实现。它允许部署一个或多个 DDS 域，同一域内的域参与者可以通过在域主题下发布/订阅来交换消息。
- RTPS layer: 实现实时发布/订阅(RTPS)协议，以实现与 DDS 应用程序的互操作性。该层充当传输层的抽象层。
- Transport Layer: Fast DDS 可用于各种传输协议，例如不可靠传输协议(UDP)、可靠传输协议(TCP)或共享内存传输协议(SHM)。

![](img/library_overview.svg)

### DDS layer

Fast DDS 的 DDS 层定义了几个关键的通信元素。用户将在其应用程序中创建这些元素，从而集成 DDS 应用程序元素并构建以数据为中心的通信系统。Fast DDS 遵循 DDS 规范，将这些通信元素定义为`实体`(Entity)。DDS 实体是指任何支持服务质量(QoS)配置并实现监听器(Listener)的对象。
- 服务质量(QoS): 定义每个实体行为的机制。
- 监听器(Listener): 用于通知实体应用程序执行期间可能发生的事件的机制。

以下列出了 DDS 实体及其描述和功能。有关每个实体的更详细说明、其 QoS 和监听器，请参阅[DDS层](https://fast-dds.docs.eprosima.com/en/latest/fastdds/dds_layer/dds_layer.html#dds-layer)部分。
- Domain: 一个正整数，用于标识 DDS 域。每个域参与者都会被分配一个 DDS 域，以便同一域内的域参与者可以通信，并隔离不同 DDS 域之间的通信。此值必须由应用程序开发人员在创建域参与者时指定。
- DomainParticipant: 包含其他 DDS 实体(例如发布者、订阅者、主题和多主题)的对象。它允许创建其包含的上述实体，并配置它们的行为。
- Publisher: 发布者使用 DataWriter 将数据写入传输层，从而在主题下发布数据。一个发布者可以包含一个或多个 DataWriter 。
- DataWriter: 负责发布消息的实体。用户在创建此实体时必须提供一个主题(Topic)，数据将发布到该主题下。发布操作通过将数据对象作为更改(Change)写入 DataWriterHistory 来完成。
- DataWriterHistory: 记录了数据对象的变更(Change)。当 DataWriter 在特定主题下发布数据时，实际上会对该数据进行一次变更。正是这次变更被记录在历史记录中。这些变更随后会被发送给订阅该特定主题的 DataReader。
- Subscriber: 订阅者使用 DataReader 订阅主题，DataReader 从传输层读取数据。订阅者负责创建和配置其包含的 DataReader 实体，并且可以包含一个或多个 DataReader 实体。
- DataReader: 是订阅主题以接收发布的实体。用户在创建此实体时必须提供订阅主题。DataReader 会将消息作为其 DataReaderHistory 中的更改接收。
- DataReaderHistory: 包含 DataReader 因订阅特定主题而接收到的数据对象的更改。
- Topic: 将发布者的 DataWriter 与订阅者的 DataReader 绑定的实体。

### RTPS layer

如上所述，Fast DDS 中的 RTPS 协议允许将 DDS 应用实体从传输层抽象出来。根据上图所示，RTPS 层有四个主要实体。
- RTPSDomain: 是 DDS 域向 RTPS 协议的扩展。
- RTPSParticipant: 包含其他 RTPS 实体的实体。它允许配置和创建其包含的实体。
- RTPSWriter: 消息的来源。它读取 DataWriterHistory 中写入的更改，并将其传输给之前已匹配的所有 RTPSReader。
- RTPSReader: 是接收消息的实体。它将 RTPSWriter 报告的更改写入 DataReaderHistory。

有关每个实体、其属性及其监听器的更详细说明，请参阅[RTPS层](https://fast-dds.docs.eprosima.com/en/latest/fastdds/rtps_layer/rtps_layer.html#rtps-layer)部分。

### Transport layer

Fast DDS 支持在多种传输协议上部署应用程序，包括 UDPv4、UDPv6、TCPv4、TCPv6 和共享内存传输(SHM)。默认情况下，DomainParticipant 会实现 UDPv4 和 SHM 两种传输协议。所有受支持的传输协议的配置详情可参见[Transport Layer](https://fast-dds.docs.eprosima.com/en/latest/fastdds/transport/transport.html#comm-transports-configuration)部分。

