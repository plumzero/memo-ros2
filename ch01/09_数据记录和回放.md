
参考:
- [Recording and playing back data](https://docs.ros.org/en/foxy/Tutorials/Beginner-CLI-Tools/Recording-And-Playing-Back-Data/Recording-And-Playing-Back-Data.html)

`ros2 bag`是一个命令行工具，用于记录系统中各个主题发布的数据。它会收集任意数量主题上的数据，并将其保存到数据库中。之后，使用者可以重放这些数据，从而复现测试和实验的结果。

通过`ros2 bag record <topic_name>`记录发布到某个主题的数据。例如:
```s
ros2 bag record /turtle1/cmd_vel
```
执行上面的命令后，会在所在目录下创建一个以时间戳信息命名的文件(例如 rosbag2_2025_12_28-12_54_03)，这个就是 bag 文件。

在 turtle_teleop_key 节点端，控制海龟的运动状态。之后停止录制。执行下面的命令回放:
```s
ros2 bag play rosbag2_2025_12_28-12_54_03
```

也可以录制多个主题。例如:
```s
ros2 bag record -o subset /turtle1/cmd_vel /turtle1/pose
```
`-o`用于显示定义一个 bag 文件名称。

执行`ros2 bag info <bag_file_name>`命令可以查看包的信息，例如:
```s
ros2 bag info subset
```
这里的输出是:
```s
Files:             subset_0.db3
Bag size:          765.3 KiB
Storage id:        sqlite3
Duration:          199.74s
Start:             Dec 28 2025 13:03:57.782 (1766898237.782)
End:               Dec 28 2025 13:07:16.857 (1766898436.857)
Messages:          12447
Topic information: Topic: /turtle1/pose | Type: turtlesim/msg/Pose | Count: 12434 | Serialization Format: cdr
                   Topic: /turtle1/cmd_vel | Type: geometry_msgs/msg/Twist | Count: 13 | Serialization Format: cdr
```
从这个信息中可以看到:
- 只要 /turtlesim 节点处于活动状态，就会定期发布关于 /turtle1/pose 的数据，可以通过`ros2 topic hz /turtle1/pose`命令查看发布频率。
- /turtlesim 订阅 /turtle1/cmd_vel，数量是 13，这正是在录制过程中按下方向键的次数。

要查看单个消息，必须打开数据库(在本例中为 sqlite3)进行检查，但这超出了 ROS2 的范围。